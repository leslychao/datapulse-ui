<div class="login-page">
  <div class="login-panel" *ngIf="vm$ | async as vm">
    <img class="login-logo" src="assets/logo.svg" alt="DataPulse" />
    <h1 class="login-title">DataPulse</h1>
    <p class="login-subtitle">Добро пожаловать</p>

    <ng-container *ngIf="!vm.authenticated; else iamGate">
      <dp-button type="button" variant="primary" (click)="login()">
        Войти
      </dp-button>
      <p class="login-note">Вы будете перенаправлены на страницу авторизации.</p>
    </ng-container>

    <ng-template #iamGate>
      <ng-container *ngIf="vm.iamState === 'ERROR'; else loading">
        <p class="login-error">Не удалось загрузить профиль.</p>
        <div class="login-actions">
          <dp-button type="button" variant="secondary" (click)="retry()">
            Повторить загрузку профиля
          </dp-button>
          <dp-button type="button" variant="danger" (click)="logout()">
            Выйти
          </dp-button>
        </div>
        <p class="login-note" *ngIf="vm.iamError?.message">{{ vm.iamError?.message }}</p>
      </ng-container>

      <ng-template #loading>
        <p class="login-loading">Загрузка профиля...</p>
      </ng-template>
    </ng-template>
  </div>
</div>
