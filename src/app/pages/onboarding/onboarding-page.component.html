<div class="page">
  <header class="page-header">
    <h1>Подключение рабочего пространства</h1>
    <p class="muted">Добавьте аккаунт и подключите маркетплейс, чтобы начать сбор данных.</p>
  </header>

  <div
    class="status-line"
    [class.is-active]="isStatusActive"
    [class.is-error]="statusState === 'error'"
  >
    <span class="status-dot"></span>
    <div>
      <div>{{ statusText }}</div>
      <div class="status-meta" *ngIf="statusHint">{{ statusHint }}</div>
    </div>
  </div>

  <div class="card form-card">
    <dp-account-form
      [disabled]="formLocked"
    ></dp-account-form>
    <dp-connection-form
      class="connection-block"
      [accountId]="accountId ?? 0"
      [disabled]="formLocked"
      [errorMessage]="tokenErrorMessage"
    ></dp-connection-form>

    <div class="form-actions">
      <dp-button type="button" variant="primary" (click)="startOnboarding()" [disabled]="formLocked">
        Начать
      </dp-button>
      <dp-button
        *ngIf="accountId && connectionId"
        type="button"
        (click)="startSync()"
        [disabled]="loading"
      >
        Синхронизировать
      </dp-button>
      <dp-button
        *ngIf="accountId && connectionId"
        type="button"
        variant="secondary"
        (click)="goToDashboard()"
        [disabled]="loading"
      >
        Перейти в кабинет
      </dp-button>
    </div>
  </div>
</div>
