<ng-container *ngIf="vm$ | async as vm">
  <dp-dashboard-shell
    [accountId]="vm.accountId"
    title="Home / Summary"
    subtitle="Сводка по прибыли и убыткам по заказам."
  >
    <div class="page">
      <div class="card" *ngIf="vm.accountId">
        <div class="table-header">
          <h2>Последние заказы</h2>
        </div>
        <p class="muted" *ngIf="vm.state.status === 'loading'">Загрузка данных...</p>
        <p class="muted" *ngIf="vm.state.status === 'error'">{{ vm.state.error }}</p>
        <p
          class="muted"
          *ngIf="vm.state.status === 'ready' && vm.state.data.length === 0"
        >
          Данные по заказам пока не получены.
        </p>

        <div class="table-wrapper" *ngIf="vm.state.status === 'ready' && vm.state.data.length">
          <table>
            <thead>
              <tr>
                <th>Marketplace</th>
                <th>Order ID</th>
                <th>PnL</th>
                <th>Net payout</th>
                <th>Revenue</th>
                <th>Items</th>
                <th>Updated</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of vm.state.data">
                <td>{{ item.sourcePlatform }}</td>
                <td>{{ item.orderId }}</td>
                <td>{{ item.pnlAmount || "—" }} {{ item.currency }}</td>
                <td>{{ item.netPayout || "—" }} {{ item.currency }}</td>
                <td>{{ item.revenueGross || "—" }} {{ item.currency }}</td>
                <td>{{ item.itemsSoldCount }}</td>
                <td>{{ item.updatedAt | date: "short" }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </dp-dashboard-shell>
</ng-container>
