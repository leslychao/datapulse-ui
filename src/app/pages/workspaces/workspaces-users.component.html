<ng-container *ngIf="vm$ | async as vm">
  <section class="table-card">
    <header class="table-header">
      <div>
        <h2>Users & Access</h2>
        <p class="muted">Команда и уровни доступа для workspace.</p>
      </div>
      <dp-button type="button" variant="primary" (click)="openInviteModal()">
        Invite user
      </dp-button>
    </header>

    <div *ngIf="vm.state.status === 'loading'">
      <dp-loader label="Загружаем участников..."></dp-loader>
    </div>

    <div class="error-text" *ngIf="vm.state.status === 'error'">
      {{ vm.state.error.message }}
    </div>

    <ng-container *ngIf="vm.state.status === 'ready'">
      <dp-operators-table
        *ngIf="vm.state.data.length > 0; else emptyState"
        [operators]="vm.state.data"
        (blockToggle)="toggleBlock($event)"
        (changeRole)="changeRole($event)"
        (deleteMember)="deleteMember($event)"
      ></dp-operators-table>
      <ng-template #emptyState>
        <div class="empty-state">
          <p class="muted">Участников пока нет.</p>
        </div>
      </ng-template>
    </ng-container>
  </section>

  <dp-modal [visible]="inviteModalVisible" (close)="closeInviteModal()">
    <div class="modal-content">
      <header class="modal-header">
        <h2>Invite user</h2>
        <p class="muted">Укажите данные участника для приглашения.</p>
      </header>
      <dp-invite-operator-form submitLabel="Отправить" (invite)="inviteMember($event)"></dp-invite-operator-form>
    </div>
  </dp-modal>
</ng-container>
