<header class="app-header">
  <a class="brand-link" [routerLink]="homePath" aria-label="Datapulse — на главную">
    <img class="brand-icon" src="assets/logo.svg" alt="" />
    <span class="brand">Datapulse</span>
  </a>

  <div class="app-header__profile" *ngIf="userProfile$ | async as profile; else loginTemplate">
    <ng-container *ngIf="workspacesState$ | async as workspacesState">
      <dp-account-switcher
        [profile]="profile"
        [workspaces]="workspacesState.status === 'ready' ? workspacesState.data : []"
        [workspacesStatus]="workspacesState.status"
        [activeWorkspaceId]="activeWorkspace$ | async"
        (selectWorkspace)="selectWorkspace($event)"
        (manageWorkspace)="goToWorkspaceSettings($event)"
        (openWorkspaces)="goToWorkspaces()"
        (openProfile)="goToProfile()"
        (createWorkspace)="goToCreateWorkspace()"
        (logout)="logout()"
      ></dp-account-switcher>
    </ng-container>
  </div>
  <ng-template #loginTemplate>
    <div class="app-header__profile">
      <dp-button
        type="button"
        variant="secondary"
        (click)="login()"
        [disabled]="isLoginRedirecting"
      >
        Войти
      </dp-button>
    </div>
  </ng-template>
</header>
